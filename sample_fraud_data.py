# -*- coding: utf-8 -*-
"""Untitled7.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Gb-_8ym1GiSSIAradWPckp8QI5wX0utH
"""

!pip install simphile

!sudo pip install requests
!sudo pip install python-firebase
!pip install python-jwt

!pip install firebase



!pip install firebase-admin

!pip install twilio

pip install opencv-python

!pip install pyrebase

!pip install datetime

import datetime
import pyrebase
from twilio.rest import Client
import firebase_admin
from firebase_admin import credentials
import cv2
from datetime import date
from firebase_admin import firestore
# import firebase_admin
# from firebase import firebase
from firebase_admin import db
from firebase_admin import credentials

# cred_obj = firebase_admin.credentials.Certificate('/content/police-f2ce4-firebase-adminsdk-zkk2p-b41281fac2.json')
# default_app = firebase_admin.initialize_app(cred_object, {'databaseURL':'https://console.firebase.google.com/u/0/project/police-f2ce4/database/police-f2ce4-default-rtdb/data/~2F'})

desc = ""
desc1 = ""
title = ""
installs = ""
HTML = ""
version = ""
appId= ""
released = ""
icon=""
developer = ""
scoree = ""

img3 = cv2.imread("/content/dom1.jpg")
img2 = cv2.imread("/content/dom2.jpg")


def checkimg(img3,img2):

  
  img1_gray = cv2.cvtColor(img3, cv2.COLOR_BGR2GRAY)
  img2_gray = cv2.cvtColor(img2, cv2.COLOR_BGR2GRAY)

  # Detect keypoints and extract local invariant descriptors using ORB
  orb = cv2.ORB_create()
  kp1, des1 = orb.detectAndCompute(img1_gray, None)
  kp2, des2 = orb.detectAndCompute(img2_gray, None)

  # Match the descriptors using BFMatcher
  bf = cv2.BFMatcher(cv2.NORM_HAMMING, crossCheck=True)
  matches = bf.match(des1, des2)

  # Sort the matches by distance
  matches = sorted(matches, key=lambda x: x.distance)

  # Calculate the percentage match
  percentage_match = (len(matches) / len(kp1)) * 100
  print("Percentage match: {:.2f}".format(percentage_match))

  # Draw the matches on the images
  # img_matches = cv2.drawMatches(img3, kp1, img2, kp2, matches[:30], None, flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)

  # Show the image with the matches
  # cv2.imshow("Matches", img_matches)
  # cv2.waitKey(0)
  # cv2.destroyAllWindows()
checkimg(img3,img2)
result = [{"title":"dominos","description":"the Domino's Pizza app allows you to order pizza and more with just a few taps! You can also track your order, earn rewards, and find new menu items. You can customize your pizza exactly the way you like it, or you can choose from one of our popular specialty pizzas. With the ability to order from anywhere, you can get hot, delicious pizza delivered to your door, fast. The app also lets you access special offers, deals, and coupon codes, so you can save money on your order. Download the app today and enjoy the convenience of ordering from Domino's on the go!","realInstalls":5673844,"score":4.73843,"icon":"","appid":"hswd8237","screenshots":"","releasedate":"Jul 6, 2006","updated":356789,"comments":["great aap delivers food at right time","great","loved it"]},
{"title":"dominios","description":"According to the Google Play Store, the Domino's Pizza app provides the convenience of ordering hot and delicious pizza delivered right to your door, fast, from anywhere with just a few taps. You can customize your pizza exactly the way you like it, or choose from one of their popular specialty pizzas. The app also lets you track your order, find new menu items, access special offers, deals, and coupon codes to save money on your order, and earn rewards. Download the app today and enjoy ordering from Domino's on the go!","realInstalls":123564,"score":3.78903,"icon":"","appid":"dominos.com","screenshots":"","releasedate":"Jul 16, 2016","updated":35788789,"comments":["fake app","got scammed","not delivered","money got dedeucted","bad"]},
 {"title":"McDonalds","description":"Download the McDonald’s App to have all the offers in the palm of your hand!Download the McDonald's™ App for unique offers!Features:- Unique offers always available in the palm of your hand! Use the app to access offers, which you can directly redeem at the cashier of the restaurant with your mobile phone!- Whatever you need to know about McDonald's™: our menu, store finder (by location), new products and new restaurants, nutritional info and even the Happy Meal™ toys of the month! Enjoy fun moments with games, competitions and tasty gifts! Stay tuned!","realInstalls":2343564,"score":4.53,"icon":"","appid":"ndkj38ry","screenshots":"","releasedate":"aug 15, 2010","updated":213789,"comments":""},
 {"title":"McDonalds Food Delivery","description":"McDelivery - Download Food Delivery App for Ordering Food Online in South & WestWhether you are craving your favourite gourmet burger or delectable, hot & gooey soft serve, the McDelivery app has got your back. The app brings the complete McDonald’s menu right on your palm. Enjoy the ease and simplicity of placing orders online and get them delivered to your doorstep in no timeMcDonald's cares for its customers and employees. So, be rest assured of the safety of your food when you place orders via the McDelivery app, one of the best apps to deliver food. Every single order is prepared & dispatched with the utmost care and with the least amount of human touchFrequent sanitisation, routine health check-ups of employees, and strict adherence to the safety protocols across our outlets help us deliver food in the safest manner. We call it the 'GOLDEN GUARANTEE' as it ensures our customers of extra safety without compromising on the quality & taste of food. So, go ahead and order your favourite McDonald's food online without any worry.Why Should You Use the McDelivery App?Placing orders from the McDelivery app is simple, safe, and convenient. Now your favourite McDonald’s items are just a few taps away. Be it McAloo Tikki, McChicken, Cappuccino, Fries, McNuggets, or anything else that is there on the menu list, just tap on the item, customise & add it to your cart, make the payment, and there you go. Indulge in your favourite McDonald’s food on any day you wish. Set up Your McDelivery App in a Few Easy StepDownload the McDelivery app to use McDonald’s online delivery services. Set up your account in a few easy steps• Register – Just enter your mobile number and tap on ‘Get OTP’ for an OTP-based registration.• Enable Location – Simply turn on the location services on your device to access the McDonald’s menu from the nearest McDonald’s restaurants.• Check Out Best Offers – Get access to the best offers where you can get free delivery with ‘Gofree’ promo code and free favourites as well.Now you don’t have to search online for McDonald’s food to deliver near me. Use the McDelivery app to effortlessly place your order and experience fast, safe, and contactless online food delivery to your location.Features of the McDelivery Aphe McDelivery app has made things easier for McDonald’s lovers. Order Customization, Made EasyYou can quickly customise your order as per your personal preferences. Whether it's an option of bun for any of the listed McDonald's burgers, add-ons such as cheese, veggies, or a choice of beverage, sides, and desserts, you will be able to customise effortlessly.• Order Tracking, Made EasyOnce you've placed your order, just sit back and relax. Our delivery man will arrive at your house as soon as your order is ready.     • Saving, Made EasyMcDonald's India provides amazing offers to its customers. You can save money on your McDonald's orders daily by using exclusive McDonald's coupons. Check out the latest deals now. • Finding Nearby Restaurants, Made EasyEnable GPS on your device to find nearby restaurants. You can also collect your order from a nearby restaurant in your area while you're on the go. • Indulgence, Made EasyInvite family and friends using your unique code to download and use the McDelivery app to receive free McDonald's burgers as rewards. • Payments, Made EasyMaking payments online for your orders is now simpler than ever. You can pay for McDonald's items via credit/debit cards, CoD, wallets, net banking, and UPIs.• Checking 'Payment History', Made Easy This feature on the app allows you to view your past payments, including details such as the amount and payment method.Now, you don’t need to search ‘McDonald’s home delivery of food near me.’ No matter where you live, McDonald's food delivery app is always at your service. Please provide our app with the best rating. We curiously read your feedback & reviews and work on them to further enhance your experience.","realInstalls":2341643,"score":3.53,"icon":"","appid":"djweg43873","screenshots":"","releasedate":"Jun 3, 2018","updated":6789,"comments":["food got delivered","bad ui","did not like it","usefull for home delivery"]}]
from simphile import jaccard_similarity, euclidian_similarity, compression_similarity
dreal = result[0]
df = result[1]
mcreal =result[2]
mcdreal=result[3]


desc1= dreal['description']
title1 = dreal['title']
# installs1 =dreal['installs']
realInstalls1 = dreal['realInstalls']
score1= dreal["score"]
appId1= dreal["appid"]
releasedate1= dreal["releasedate"]
comments1=dreal["comments"]
updated1 = dreal["updated"]



desc2= df['description']
title2 = df['title']
# installs2=df['installs']
realInstalls2 = df['realInstalls']
score2= df["score"]
appId2= df["appid"]
releasedate2= df["releasedate"]
comments2=df["comments"]
updated2 = df["updated"]

date2 = datetime.datetime.strptime(releasedate2, "%b %d, %Y")
formatted_date2 = date2.strftime("%Y/%m/%d")
date1 = datetime.datetime.strptime(releasedate1, "%b %d, %Y")
formatted_date1 = date1.strftime("%Y/%m/%d")
flag='Null'

if date1< date2:
  if realInstalls1> realInstalls2 and updated1>updated2:
    flag='ok'
  else:
    flag=76.31
else:
  if realInstalls2>realInstalls1 and updated1>updated2:
    flag='ok'
  else:
    flag=76.31
print(flag)

k = euclidian_similarity(desc1, desc2)*100

print("Description Similarity :",k)
print("-----------")
l = compression_similarity(title1 , title2)*100
print("Title Similarity :",l)



m = compression_similarity(appId2 , appId1)*100
print("AppId Similarity :",m)




def commentschecking(comments):
  alert=0
  keywords=['fraud','fake','scam','lost money','Ripoff','deceptive','misleading','cheating','phishing','unauthorized charge','con artist','trick','scandal','hoax','con','deceit','defraud','swindle','con game','bait']
  for my_string in comments:
    if([c for c in my_string.split() if c in keywords]):
      alert = 100
  return alert

a=commentschecking(comments1)
print(a)

b=commentschecking(comments2)
print(b)


mean = (b + flag +k+l+m)/5
print("----")
print("----")
print("----")
print("----")
print(mean)
print("----")
print("----")
print("----")


data = {
    "appid": appId2,
    "title": title2
}




# ref = db.reference("/Fraud_Details/1/")
# best_sellers = ref.get()
# # print(best_sellers)
# for key, value in best_sellers.items():
#   value['appid'] = appId2
#   value['title'] = title2


if(b == 100 or mean>71.6 ):
  print("Kuch to gad-bad hai")
  account_sid='AC18eb98db71a0770490ac1982fe03b818'
  auth_token='0359b4ba6915cc958cfcce2bed6962b4'
  twilionumber='+13137234370'
  mynumber='+919593700105'
  appid=appId2
  title=title1
  print(appid)
  print(title)
  client=Client(account_sid,auth_token)
  message=client.messages.create(body='this is to inform you that the app with appid-'+appid+' and title-'+title+' is fraud',from_=twilionumber,to=mynumber)

i = 3
firebaseConfig = {
  "apiKey": "AIzaSyC_-hBXpK-3eZvDTHKb2DIurcVvx-6q1lc",
  "authDomain": "police-f2ce4.firebaseapp.com",
  "databaseURL": "https://police-f2ce4-default-rtdb.firebaseio.com",
 " projectId": "police-f2ce4",
  "storageBucket": "police-f2ce4.appspot.com",
 "messagingSenderId": "342750787617",
  "appId": "1:342750787617:web:44e18d97438a7fb96a0b60"
};

firebase = pyrebase.initialize_app(firebaseConfig)
db=firebase.database()
if not firebase_admin._apps:
  cred_obj2 = firebase_admin.credentials.Certificate('/content/police-f2ce4-firebase-adminsdk-zkk2p-b41281fac2.json')
  default_app2 = firebase_admin.initialize_app(cred_obj2, {'databaseURL':'https://police-f2ce4-default-rtdb.firebaseio.com'})

db.child("Fraud_Details").child(i).child("appid").set(appId2)
db.child("Fraud_Details").child(i).child("title").set(title2)
i+=1



76.71% , 76.31% , 93.91%, 70.96% , 50%, 100%

